# 신입사원 역량테스트 시스템 - 설치 및 실행 가이드

## 📋 시스템 요구사항

### 필수 소프트웨어
- **Node.js** 16.0.0 이상 [다운로드](https://nodejs.org/)
- **웹브라우저** (Chrome, Firefox, Safari, Edge)

### 권장 환경
- **운영체제**: Windows 10/11, macOS 10.14+, Ubuntu 18.04+
- **메모리**: 4GB RAM 이상
- **디스크**: 500MB 여유 공간

## 🔑 **중요: API 키 설정 (필수)**

### 카카오 로그인 기능을 사용하려면 카카오 API 키가 필요합니다

#### 1. 카카오 개발자 계정 생성
1. [카카오 개발자 콘솔](https://developers.kakao.com/) 접속
2. 카카오 계정으로 로그인
3. "내 애플리케이션" > "애플리케이션 추가하기" 클릭

#### 2. 카카오 앱 생성 및 설정
1. **앱 이름**: `신입사원 역량테스트` (또는 원하는 이름)
2. **회사명**: 회사명 입력
3. 앱 생성 완료 후 **앱 키** 확인
4. **JavaScript 키**를 복사해둡니다

#### 3. 플랫폼 설정
1. **플랫폼** 탭에서 **Web 플랫폼 등록**
2. **사이트 도메인**: 
   - 개발용: `http://localhost:3000`
   - 운영용: 실제 도메인 입력 (예: `https://your-domain.com`)

#### 4. 카카오 로그인 활성화
1. **카카오 로그인** 탭에서 **활성화 설정** ON
2. **Redirect URI 등록**:
   - `http://localhost:3000` (개발용)
   - 실제 도메인 (운영용)
3. **동의항목** 설정:
   - 닉네임: 필수
   - 이메일: 선택 (권장)

## 🚀 빠른 시작 가이드

### 1단계: 파일 압축 해제
```bash
# 압축 파일을 원하는 폴더에 압축 해제
unzip outsourcingTEST_정리완료_20250604.zip
cd outsourcingTEST
```

### 2단계: 의존성 설치
```bash
# 프로젝트 폴더에서 실행
npm install
```

### 3단계: 카카오 API 키 설정 ⚠️ **반드시 필요**
다음 파일에서 `your_kakao_javascript_key_here`를 실제 카카오 JavaScript 키로 교체:

#### 📄 `client/js/utils/common.js` (3-4줄) - **이 파일만 수정하면 됩니다**
```javascript
KAKAO_API_KEY: window.location.hostname === 'localhost'
    ? '실제_카카오_JavaScript_키'  // 개발용
    : '실제_카카오_JavaScript_키'  // 프로덕션용
```

### 4단계: 환경 설정 (선택사항)
#### JWT 비밀키 변경 (보안 강화)
`.env` 파일에서:
```bash
JWT_SECRET=your_custom_secret_key_here_make_it_long_and_secure
```

### 5단계: 서버 실행
```bash
# 서버 시작
npm start
```

### 6단계: 웹사이트 접속
브라우저에서 다음 주소로 접속:
```
http://localhost:3000
```

## 🔧 환경 설정 (선택사항)

### 포트 변경
기본 포트(3000)를 변경하려면 `.env` 파일에서:
```bash
PORT=8080
```

### 데이터베이스 설정
```bash
# 초기 데이터베이스 설정 (선택사항)
npm run init-db
```

## 📱 기능 테스트

### 1. 회원가입/로그인 테스트
- **이메일 회원가입**: 메인 페이지에서 "회원가입" 클릭
- **카카오 로그인**: API 키 설정 후 "카카오톡으로 로그인" 클릭
- **테스트 계정**: `test@test.com` / `test123`

### 2. 역량테스트 실행
- 로그인 후 "검사 시작하기" 클릭
- 75개 문항 (5개 영역별 15문항씩)
- 각 문항: 5점 척도 ("전혀 그렇지 않다" ~ "매우 그렇다")

### 3. 결과 확인
- 테스트 완료 후 자동으로 결과 페이지 이동
- 마이페이지에서 과거 결과 조회 가능
- 5개 영역별 점수 및 종합 점수 확인

## ⚠️ 카카오 로그인 문제 해결

### "Invalid app key" 오류
- 카카오 JavaScript 키가 올바르게 설정되었는지 확인
- 카카오 개발자 콘솔에서 앱 상태가 "서비스 중"인지 확인

### "허용되지 않은 도메인" 오류  
- 카카오 개발자 콘솔 > 플랫폼 설정에서 도메인 등록 확인
- `http://localhost:3000` 정확히 등록되었는지 확인

### 로그인 후 정보 수집 실패
- 카카오 로그인 > 동의항목에서 닉네임, 이메일 설정 확인
- 비즈니스 채널이 필요한 정보는 비즈 앱으로 전환 필요

## 🛠️ 일반적인 문제 해결

### 서버 실행 오류
```bash
# 포트 충돌 시
lsof -ti:3000 | xargs kill -9
npm start
```

### 브라우저 접속 안됨
- 방화벽 설정 확인
- 브라우저 캐시 삭제 (Ctrl+F5)
- 다른 브라우저로 시도

### Node.js 버전 문제
```bash
# Node.js 버전 확인
node --version
# 16.0.0 이상이어야 함
```

## 🔐 보안 설정 체크리스트

### ✅ 완료해야 할 보안 설정
1. **카카오 API 키 설정** - `client/js/utils/common.js` 파일에서 교체 완료
2. **JWT_SECRET 변경** - `.env` 파일에서 고유한 값으로 설정
3. **카카오 앱 도메인 제한** - 개발자 콘솔에서 허용 도메인만 등록
4. **기본 테스트 계정 비밀번호 변경** (선택사항)


## 📞 기술 지원

### 설정 필요한 주요 값들
1. **카카오 JavaScript 키**: `your_kakao_javascript_key_here` (`client/js/utils/common.js` 파일만)
2. **JWT 비밀키**: `JWT_SECRET` (.env 파일)
3. **서버 포트**: `PORT` (.env 파일, 기본값: 3000)


### 로그 확인
문제 발생 시 브라우저 개발자 도구(F12) > Console에서 오류 메시지 확인

## 🌐 AWS 배포 가이드

### 📋 AWS 배포 준비사항
- **AWS 계정** 및 EC2 인스턴스
- **도메인** (예: `your-domain.com`)
- **SSL 인증서** (Let's Encrypt 권장)

### 🚀 AWS EC2 배포 단계별 가이드

#### 1단계: EC2 인스턴스 설정
```bash
# Ubuntu 22.04 LTS 기준
# 1. 인스턴스 연결 후 패키지 업데이트
sudo apt update && sudo apt upgrade -y

# 2. Node.js 18.x 설치
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt-get install -y nodejs

# 3. PM2 글로벌 설치 (프로세스 매니저)
sudo npm install -g pm2

# 4. 방화벽 설정
sudo ufw allow 22    # SSH
sudo ufw allow 80    # HTTP
sudo ufw allow 443   # HTTPS
sudo ufw enable
```

#### 2단계: 프로젝트 배포
```bash
# 1. 홈 디렉토리로 이동
cd ~

# 2. 압축 파일 업로드 후 압축 해제
unzip outsourcingTEST_최종_20250604.zip
cd outsourcingTEST

# 3. 의존성 설치
npm install --production

# 4. 환경 설정 파일 수정
nano .env
```

#### 3단계: 환경설정 (.env 파일)
```bash
# AWS 배포용 .env 설정
PORT=3000
NODE_ENV=production
JWT_SECRET=your_super_long_and_secure_jwt_secret_key_here_please_change_this
```

#### 4단계: 카카오 API 설정 (중요!)
```bash
# 1. common.js 파일 수정
nano client/js/utils/common.js
```

**프로덕션 도메인으로 수정:**
```javascript
KAKAO_API_KEY: window.location.hostname === 'localhost'
    ? 'your_kakao_javascript_key_here'  // 개발용 (사용하지 않음)
    : 'your_kakao_javascript_key_here'  // ✅ 프로덕션용 (실제 키 입력)
```

#### 5단계: 카카오 개발자 콘솔 설정 변경
1. [카카오 개발자 콘솔](https://developers.kakao.com/) 접속
2. **플랫폼 설정**에서 Web 플랫폼 도메인 추가:
   - `https://your-domain.com` (HTTPS 필수!)
3. **카카오 로그인 Redirect URI** 추가:
   - `https://your-domain.com`

#### 6단계: Nginx 설정 (선택사항, 권장)
```bash
# 1. Nginx 설치
sudo apt install nginx -y

# 2. Nginx 설정 파일 생성
sudo nano /etc/nginx/sites-available/assessment
```

**Nginx 설정 내용:**
```nginx
server {
    listen 80;
    server_name your-domain.com www.your-domain.com;
    
    location / {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
    }
}
```

```bash
# 3. 설정 활성화
sudo ln -s /etc/nginx/sites-available/assessment /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl restart nginx
```

#### 7단계: SSL 인증서 설정 (Let's Encrypt)
```bash
# 1. Certbot 설치
sudo apt install certbot python3-certbot-nginx -y

# 2. SSL 인증서 발급
sudo certbot --nginx -d your-domain.com -d www.your-domain.com

# 3. 자동 갱신 설정 확인
sudo crontab -l | grep certbot
```

#### 8단계: PM2로 애플리케이션 실행
```bash
# 1. PM2 설정 파일 생성
nano ecosystem.config.js
```

**PM2 설정 파일 내용:**
```javascript
module.exports = {
  apps: [{
    name: 'assessment-app',
    script: './server/server.js',
    instances: 1,
    autorestart: true,
    watch: false,
    max_memory_restart: '1G',
    env: {
      NODE_ENV: 'production',
      PORT: 3000
    }
  }]
};
```

```bash
# 2. PM2로 애플리케이션 시작
pm2 start ecosystem.config.js

# 3. PM2 상태 확인
pm2 status

# 4. 시스템 재시작 시 자동 실행 설정
pm2 startup
pm2 save
```

### 🔧 AWS 보안 그룹 설정

**인바운드 규칙:**
- **SSH (22)**: 내 IP만 허용
- **HTTP (80)**: 0.0.0.0/0 (모든 IP)
- **HTTPS (443)**: 0.0.0.0/0 (모든 IP)

### 📊 배포 후 확인사항

#### ✅ 체크리스트
1. **웹사이트 접속**: `https://your-domain.com`
2. **카카오 로그인 테스트**
3. **회원가입/로그인 기능**
4. **역량테스트 실행**
5. **SSL 인증서 작동 확인**

#### 🛠️ AWS 배포 문제 해결

**포트 연결 오류:**
```bash
# 서버 상태 확인
pm2 logs assessment-app
sudo netstat -tlnp | grep :3000
```

**Nginx 오류:**
```bash
# Nginx 상태 및 로그 확인
sudo systemctl status nginx
sudo tail -f /var/log/nginx/error.log
```

**카카오 로그인 오류:**
- 카카오 개발자 콘솔에서 도메인 정확히 등록했는지 확인
- HTTPS 설정이 제대로 되었는지 확인

### 💰 AWS 비용 최적화 팁

1. **t3.micro 인스턴스** (프리티어 가능)
2. **EBS 볼륨**: 8-20GB 면충분
3. **CloudWatch**: 기본 모니터링만 사용
4. **Elastic IP**: 인스턴스 중지 시 해제

### 🔄 배포 자동화 (고급)

#### GitHub Actions 배포 (선택사항)
```yaml
# .github/workflows/deploy.yml
name: Deploy to AWS
on:
  push:
    branches: [ main ]
jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2
    - name: Deploy to server
      uses: appleboy/ssh-action@v0.1.5
      with:
        host: ${{ secrets.HOST }}
        username: ubuntu
        key: ${{ secrets.KEY }}
        script: |
          cd ~/outsourcingTEST
          git pull origin main
          npm install --production
          pm2 restart assessment-app
```

## 📝 추가 참고사항

### 🔐 보안 강화 (프로덕션 환경)
1. **SSH 키 전용 접속** (비밀번호 로그인 비활성화)
2. **정기적인 패키지 업데이트**
3. **방화벽 설정 점검**
4. **JWT_SECRET 정기 교체**
5. **SSL 인증서 자동 갱신 확인**

### 📈 성능 모니터링
```bash
# PM2 모니터링
pm2 monit

# 시스템 리소스 확인
htop
df -h
```

### 💾 백업 설정
```bash
# 데이터 백업 스크립트 (cron 등록 권장)
#!/bin/bash
backup_date=$(date +%Y%m%d_%H%M%S)
cp -r ~/outsourcingTEST/data ~/backups/data_$backup_date
```

---

**프로젝트**: 신입사원 역량테스트 시스템  
**버전**: 1.0.0  
**마지막 업데이트**: 2025.06.04  
**배포 가이드 버전**: 1.0 